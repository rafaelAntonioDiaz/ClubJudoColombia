# ===================================================
# 1. BASE DE DATOS (NEON.TECH - POSTGRESQL)
# ===================================================
# Se inyectarán automáticamente desde las variables de entorno de Google Cloud Run
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# MAGIA SERVERLESS (HikariCP): Limitamos las conexiones para no saturar
# el nivel gratuito de Neon y evitamos que las conexiones "se duerman".
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.keepalive-time=30000

# ===================================================
# 2. JPA / HIBERNATE (PRODUCCIÓN)
# ===================================================
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update

# VITAL: Apagamos los logs de SQL. En la nube, cada log cuesta CPU y dinero.
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# ===================================================
# 3. ALMACENAMIENTO CLOUDFLARE R2
# ===================================================
cloudflare.r2.bucket-name=judo-cloudflare
cloudflare.r2.access-key=${CLOUDFLARE_R2_ACCESS_KEY}
cloudflare.r2.secret-key=${CLOUDFLARE_R2_SECRET_KEY}
cloudflare.r2.endpoint=${CLOUDFLARE_R2_ENDPOINT}
cloudflare.r2.public-url=${CLOUDFLARE_R2_PUBLIC_URL}

# Límites de subida para las fotos y PDFs (Mantenidos igual que en Dev)
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# ===================================================
# 4. CORREO REAL (PRODUCCIÓN)
# ===================================================
# Credenciales del servicio SMTP real (Gmail, SendGrid, Resend, etc.)
spring.mail.host=${SMTP_HOST}
spring.mail.port=587
spring.mail.username=${SMTP_USERNAME}
spring.mail.password=${SMTP_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# ===================================================
# 5. OPTIMIZACIÓN VAADIN FRONT-END
# ===================================================
# VITAL: Le dice a Vaadin que minifique el JS y CSS para que la app cargue 3 veces más rápido.
vaadin.productionMode=true